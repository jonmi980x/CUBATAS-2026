<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cubatas 2026 PRO</title>

<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>

<style>
body {
  font-family: system-ui, sans-serif;
  background: #0f172a;
  color: white;
  margin: 0;
  padding: 16px;
}
h1 { text-align: center; }
.grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
  gap: 10px;
}
button {
  background: #22c55e;
  border: none;
  border-radius: 14px;
  padding: 12px;
  font-weight: 600;
}
.card {
  background: #1e293b;
  border-radius: 20px;
  padding: 14px;
  margin-top: 20px;
}
.row {
  display: flex;
  justify-content: space-between;
  margin: 6px 0;
}
</style>
</head>

<body>
<h1>ğŸ¹ Cubatas 2026 PRO</h1>

<div class="grid" id="buttons"></div>

<div class="card">
  <h3>ğŸ† Ranking</h3>
  <div id="ranking"></div>
</div>

<div class="card">
  <h3>ğŸ“‹ Historial</h3>
  <div id="history"></div>
</div>

<div class="card">
  <button onclick="reset()">ğŸ”„ Reset mensual</button>
</div>

<script>
const firebaseConfig = {
    apiKey: "AIzaSyC2O75FYQDljmMeu36yB94KbOmAZdgX4d4",
  authDomain: "cubatas-2026.firebaseapp.com",
  databaseURL: "https://cubatas-2026-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "cubatas-2026",
  storageBucket: "cubatas-2026.firebasestorage.app",
  messagingSenderId: "754889583450",
  appId: "1:754889583450:web:aa584f7a906290beffe163",
  measurementId: "G-WZGVRDT8V1"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

const people = ["Jonmi","Llorden","Marce","Lucho","Markitos","Boveda","Diego","Bipo","Wichi","Ferrer","Rabu"];
const drinks = [
  {n:"Cubata",p:5},
  {n:"Chupito",p:2},
  {n:"Tequila",p:3},
  {n:"CaÃ±a",p:1}
];

const buttons = document.getElementById("buttons");
const ranking = document.getElementById("ranking");
const history = document.getElementById("history");

people.forEach(p=>{
  db.ref("points/"+p).once("value",s=>{
    if(s.val()==null) db.ref("points/"+p).set(0);
  });
});

function add(p,d){
  const date = new Date().toLocaleDateString();
  db.ref("points/"+p).transaction(v=>(v||0)+d.p);
  db.ref("history").transaction(h=>{
    h=h||[];
    h.push(`${date}: ${p} + ${d.n} (${d.p}p)`);
    return h.slice(-20);
  });
}

function reset(){
  if(confirm("Â¿Reset mensual?")){
    people.forEach(p=>db.ref("points/"+p).set(0));
  }
}

people.forEach(p=>{
  drinks.forEach(d=>{
    const b=document.createElement("button");
    b.textContent=`${p} + ${d.n}`;
    b.onclick=()=>add(p,d);
    buttons.appendChild(b);
  });
});

db.ref("points").on("value",s=>{
  ranking.innerHTML="";
  const data=s.val()||{};
  people.sort((a,b)=>(data[b]||0)-(data[a]||0)).forEach(p=>{
    const r=document.createElement("div");
    r.className="row";
    r.innerHTML=`<span>${p}</span><strong>${data[p]||0}</strong>`;
    ranking.appendChild(r);
  });
});

db.ref("history").on("value",s=>{
  history.innerHTML="";
  (s.val()||[]).slice().reverse().forEach(e=>{
    const d=document.createElement("div");
    d.textContent=e;
    history.appendChild(d);
  });
});
</script>
</body>
</html>

