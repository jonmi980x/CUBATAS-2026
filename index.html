<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ¹ Cubatas 2026</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>

<style>
body {
  font-family: system-ui, sans-serif;
  background:#0f172a;
  color:white;
  margin:0;
  padding:16px;
}
h1, h2 { text-align:center; }

.toggles {
  display:flex;
  flex-direction:column;
  gap:10px;
  margin-bottom:20px;
}
.toggle {
  padding:12px;
  border:none;
  border-radius:14px;
  background:#1e293b;
  color:white;
  font-size:16px;
  cursor:pointer;
}
.toggle.active {
  background:#22c55e;
  color:black;
}

.section { margin-bottom:30px; }

.row {
  display:flex;
  justify-content:space-between;
  align-items:center;
  background:#1e293b;
  padding:10px;
  border-radius:14px;
  margin-bottom:8px;
}
.name {
  width:90px;
  font-weight:700;
}
.actions button {
  margin-left:4px;
  border:none;
  border-radius:8px;
  padding:4px 8px;
  cursor:pointer;
}
.pts {
  font-weight:bold;
  margin-left:6px;
}
.rank-row {
  display:flex;
  justify-content:space-between;
  margin:6px 0;
}
</style>
</head>

<body>

<h1>ğŸ¹ Cubatas 2026</h1>

<!-- BOTONES -->
<div class="toggles">
  <button id="toggleMensual" class="toggle active" onclick="toggleSection('mensual')">
    ğŸ“… Mensual
  </button>
  <button id="toggleHistorico" class="toggle active" onclick="toggleSection('historico')">
    ğŸ“š HistÃ³rico
  </button>
</div>

<!-- MENSUAL -->
<div id="mensualSection" class="section">
  <h2>ğŸ—“ï¸ Recuento mensual</h2>
  <div id="mensualApp"></div>

  <h2>ğŸ† ClasificaciÃ³n mensual</h2>
  <div id="mensualRanking"></div>
</div>

<!-- HISTÃ“RICO -->
<div id="historicoSection" class="section">
  <h2>ğŸ“š ClasificaciÃ³n histÃ³rica</h2>
  <div id="historicoRanking"></div>
</div>

<script>
/* ğŸ”§ TU FIREBASE (NO CAMBIO ESTO) */
const firebaseConfig = {
  <!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ¹ Cubatas 2026</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>

<style>
body {
  font-family: system-ui, sans-serif;
  background:#0f172a;
  color:white;
  margin:0;
  padding:16px;
}
h1, h2 { text-align:center; }

.toggles {
  display:flex;
  flex-direction:column;
  gap:10px;
  margin-bottom:20px;
}
.toggle {
  padding:12px;
  border:none;
  border-radius:14px;
  background:#1e293b;
  color:white;
  font-size:16px;
  cursor:pointer;
}
.toggle.active {
  background:#22c55e;
  color:black;
}

.section { margin-bottom:30px; }

.row {
  display:flex;
  justify-content:space-between;
  align-items:center;
  background:#1e293b;
  padding:10px;
  border-radius:14px;
  margin-bottom:8px;
}
.name {
  width:90px;
  font-weight:700;
}
.actions button {
  margin-left:4px;
  border:none;
  border-radius:8px;
  padding:4px 8px;
  cursor:pointer;
}
.pts {
  font-weight:bold;
  margin-left:6px;
}
.rank-row {
  display:flex;
  justify-content:space-between;
  margin:6px 0;
}
</style>
</head>

<body>

<h1>ğŸ¹ Cubatas 2026</h1>

<!-- BOTONES -->
<div class="toggles">
  <button id="toggleMensual" class="toggle active" onclick="toggleSection('mensual')">
    ğŸ“… Mensual
  </button>
  <button id="toggleHistorico" class="toggle active" onclick="toggleSection('historico')">
    ğŸ“š HistÃ³rico
  </button>
</div>

<!-- MENSUAL -->
<div id="mensualSection" class="section">
  <h2>ğŸ—“ï¸ Recuento mensual</h2>
  <div id="mensualApp"></div>

  <h2>ğŸ† ClasificaciÃ³n mensual</h2>
  <div id="mensualRanking"></div>
</div>

<!-- HISTÃ“RICO -->
<div id="historicoSection" class="section">
  <h2>ğŸ“š ClasificaciÃ³n histÃ³rica</h2>
  <div id="historicoRanking"></div>
</div>

<script>
/* ğŸ”§ TU FIREBASE (NO CAMBIO ESTO) */
const firebaseConfig = {
  apiKey: "TU_APIKEY",
  authDomain: "TU_PROJECT.firebaseapp.com",
  databaseURL: "https://TU_PROJECT.firebaseio.com",
  projectId: "TU_PROJECT",
  storageBucket: "TU_PROJECT.appspot.com",
  messagingSenderId: "TU_SENDERID",
  appId: "TU_APPID"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

/* ğŸ‘¥ NOMBRES (CLAROS Y FIJOS) */
const people = [
  "Jonmi",
  "Llorden",
  "Marce",
  "Lucho",
  "Markitos",
  "Boveda",
  "Diego",
  "Bipo",
  "Wichi",
  "Ferrer",
  "Rabu"
];

/* REFERENCIAS HTML (ESTO ERA LO QUE FALTABA) */
const mensualApp = document.getElementById("mensualApp");
const mensualRanking = document.getElementById("mensualRanking");
const historicoRanking = document.getElementById("historicoRanking");

/* ESTADO */
const state = { mensual:true, historico:true };

/* TOGGLES */
function toggleSection(type){
  state[type] = !state[type];
  document.getElementById(type+"Section").style.display =
    state[type] ? "block" : "none";
  document.getElementById("toggle"+cap(type))
    .classList.toggle("active", state[type]);
}
function cap(s){ return s.charAt(0).toUpperCase()+s.slice(1); }

/* INICIALIZAR DATOS */
people.forEach(name=>{
  db.ref("users/"+name).once("value",snap=>{
    if(!snap.exists()){
      db.ref("users/"+name).set({
        mensual:{cubata:0,cana:0,chupito:0},
        historico:{cubata:0,cana:0,chupito:0}
      });
    }
  });
});

/* PUNTOS */
function points(d){
  return d.cubata*5 + d.cana*1 + d.chupito*2;
}

/* SUMAR / RESTAR */
function add(name,type){
  db.ref(`users/${name}/mensual/${type}`)
    .transaction(v=>(v||0)+1);
}
function removeDrink(name,type){
  db.ref(`users/${name}/mensual/${type}`)
    .transaction(v=>v>0?v-1:0);
}

/* RENDER PRINCIPAL */
db.ref("users").on("value",snap=>{
  const data = snap.val() || {};

  mensualApp.innerHTML = "";
  mensualRanking.innerHTML = "";
  historicoRanking.innerHTML = "";

  const mensualArr = [];
  const historicoArr = [];

  Object.entries(data).forEach(([name,u])=>{
    const m = u.mensual;
    const h = u.historico;

    mensualArr.push({name,pts:points(m)});
    historicoArr.push({name,pts:points(h)});

    const row = document.createElement("div");
    row.className = "row";
    row.innerHTML = `
      <div class="name">${name}</div>
      <div class="actions">
        <button onclick="add('${name}','cubata')">ğŸ¹ ${m.cubata}</button>
        <button onclick="removeDrink('${name}','cubata')">âˆ’</button>
        <button onclick="add('${name}','cana')">ğŸº ${m.cana}</button>
        <button onclick="removeDrink('${name}','cana')">âˆ’</button>
        <button onclick="add('${name}','chupito')">ğŸ¥ƒ ${m.chupito}</button>
        <button onclick="removeDrink('${name}','chupito')">âˆ’</button>
        <span class="pts">${points(m)} pts</span>
      </div>
    `;
    mensualApp.appendChild(row);
  });

  mensualArr.sort((a,b)=>b.pts-a.pts).forEach((u,i)=>{
    const d = document.createElement("div");
    d.className="rank-row";
    d.innerHTML=`<span>${["ğŸ¥‡","ğŸ¥ˆ","ğŸ¥‰"][i]||""} ${u.name}</span><strong>${u.pts}</strong>`;
    mensualRanking.appendChild(d);
  });

  historicoArr.sort((a,b)=>b.pts-a.pts).forEach((u,i)=>{
    const d = document.createElement("div");
    d.className="rank-row";
    d.innerHTML=`<span>${["ğŸ¥‡","ğŸ¥ˆ","ğŸ¥‰"][i]||""} ${u.name}</span><strong>${u.pts}</strong>`;
    historicoRanking.appendChild(d);
  });
});
</script>

</body>
</html>
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

/* ğŸ‘¥ NOMBRES (CLAROS Y FIJOS) */
const people = [
  "Jonmi",
  "Llorden",
  "Marce",
  "Lucho",
  "Markitos",
  "Boveda",
  "Diego",
  "Bipo",
  "Wichi",
  "Ferrer",
  "Rabu"
];

/* REFERENCIAS HTML (ESTO ERA LO QUE FALTABA) */
const mensualApp = document.getElementById("mensualApp");
const mensualRanking = document.getElementById("mensualRanking");
const historicoRanking = document.getElementById("historicoRanking");

/* ESTADO */
const state = { mensual:true, historico:true };

/* TOGGLES */
function toggleSection(type){
  state[type] = !state[type];
  document.getElementById(type+"Section").style.display =
    state[type] ? "block" : "none";
  document.getElementById("toggle"+cap(type))
    .classList.toggle("active", state[type]);
}
function cap(s){ return s.charAt(0).toUpperCase()+s.slice(1); }

/* INICIALIZAR DATOS */
people.forEach(name=>{
  db.ref("users/"+name).once("value",snap=>{
    if(!snap.exists()){
      db.ref("users/"+name).set({
        mensual:{cubata:0,cana:0,chupito:0},
        historico:{cubata:0,cana:0,chupito:0}
      });
    }
  });
});

/* PUNTOS */
function points(d){
  return d.cubata*5 + d.cana*1 + d.chupito*2;
}

/* SUMAR / RESTAR */
function add(name,type){
  db.ref(`users/${name}/mensual/${type}`)
    .transaction(v=>(v||0)+1);
}
function removeDrink(name,type){
  db.ref(`users/${name}/mensual/${type}`)
    .transaction(v=>v>0?v-1:0);
}

/* RENDER PRINCIPAL */
db.ref("users").on("value",snap=>{
  const data = snap.val() || {};

  mensualApp.innerHTML = "";
  mensualRanking.innerHTML = "";
  historicoRanking.innerHTML = "";

  const mensualArr = [];
  const historicoArr = [];

  Object.entries(data).forEach(([name,u])=>{
    const m = u.mensual;
    const h = u.historico;

    mensualArr.push({name,pts:points(m)});
    historicoArr.push({name,pts:points(h)});

    const row = document.createElement("div");
    row.className = "row";
    row.innerHTML = `
      <div class="name">${name}</div>
      <div class="actions">
        <button onclick="add('${name}','cubata')">ğŸ¹ ${m.cubata}</button>
        <button onclick="removeDrink('${name}','cubata')">âˆ’</button>
        <button onclick="add('${name}','cana')">ğŸº ${m.cana}</button>
        <button onclick="removeDrink('${name}','cana')">âˆ’</button>
        <button onclick="add('${name}','chupito')">ğŸ¥ƒ ${m.chupito}</button>
        <button onclick="removeDrink('${name}','chupito')">âˆ’</button>
        <span class="pts">${points(m)} pts</span>
      </div>
    `;
    mensualApp.appendChild(row);
  });

  mensualArr.sort((a,b)=>b.pts-a.pts).forEach((u,i)=>{
    const d = document.createElement("div");
    d.className="rank-row";
    d.innerHTML=`<span>${["ğŸ¥‡","ğŸ¥ˆ","ğŸ¥‰"][i]||""} ${u.name}</span><strong>${u.pts}</strong>`;
    mensualRanking.appendChild(d);
  });

  historicoArr.sort((a,b)=>b.pts-a.pts).forEach((u,i)=>{
    const d = document.createElement("div");
    d.className="rank-row";
    d.innerHTML=`<span>${["ğŸ¥‡","ğŸ¥ˆ","ğŸ¥‰"][i]||""} ${u.name}</span><strong>${u.pts}</strong>`;
    historicoRanking.appendChild(d);
  });
});
</script>

</body>
</html>
